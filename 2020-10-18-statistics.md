# 2020-10-18-statistics

# 11강- 포아송분포 (The Poisson distribution)

- **핵심키워드**
    - `포아송분포(poisson distribution)`
    - `포아송 근사(poisson approximation/ poisson paradigm)`
    - `이산확률분포`
    - `Birthday Problem`

## Sympathetic magic

확률 변수(random variable)와 분포(distribution)을 혼동하지 말자!!

확률 변수를 더하는 것과 확률질량함수(PMF)를 더하는 것은 다른 개념이다.

~~애초에 P(X=x) + P(Y=y)라는 식은 성립하지 않음. (PMF의 덧셈)~~

"확률 변수는 확률 분포의 값이다."라고 생각하는 게 쉬울 것 같다..

![2020-10-18-statistics](/assets/img/2020-10-18-statistics/Untitled.png)

확률 분포

위의 그림은 $P(x_1 \le X \le x_2)$ , 확률 변수 X가 x1과 x2 사이에 있을 확률이다.

강의에서는 **확률 변수**를 집, **확률 분포**를 설계도라고 가정하고 있다.

설계도는 특정 확률을 가지고 모든 집의 모양을 정할 수 있고,

그리고 확률변수는 그렇게 만들어진 집이다.

## Poisson distribution

의미: 굉장히 여러 번의 시행을 하지만 성공의 확률은 매우 낮을 때, 성공 횟수 세기

- **포아송 분포의 확률 질량 함수**

    ![/assets/img/2020-10-18-statistics/Untitled%201.png](/assets/img/2020-10-18-statistics/Untitled%201.png)

    ![/assets/img/2020-10-18-statistics/Untitled%202.png](/assets/img/2020-10-18-statistics/Untitled%202.png)

- **포아송 분포의 기대값**

    ![/assets/img/2020-10-18-statistics/Untitled%203.png](/assets/img/2020-10-18-statistics/Untitled%203.png)

    식을 차례대로 전개해보면 분모와 분자에 $\lambda$  의 지수가 k-1로 통일된다.

    밑의 식을 위의 식으로 변환 시킬 수 있다.

    둘 다 $e^{\lambda}$의 테일러 급수이기 때문이다.

- **포아송 분포가 중요한 이유**

    포아송분포는 실제 이산형 데이터의 모델로서 실제로 가장 많고 널리 쓰이는 분포이다. 자주 쓰이는 응용을 보면, 음수가 아닌 정수이기 때문에 숫자를 세는 응용에서 쓰인다.

- **예제 1. 한시간 안에 받은 이메일 개수**

    이 문제가 반드시 포아송이 아닐 수도 있다. 포아송 분포라고 가정할 뿐이다. 이메일 개수를 세는 응용이기 때문에 포아송 분포로 시작하면 적당하다.

    그렇다면 직과적으로 봤을 때 이게 왜 포아송 분포라는 것일까? 생각해보자.  1시간 동안 나에게 이메일을 보낼 수 있는 사람은 많을 것이다. 하지만 주기적으로 이메일을 주고 받는 사이가 아니면 나에게 이메일을 보낼 확률은 아주 낮을 것이다.  어떤 사람이 1시간 안에 나에게 이메일을 쓰는 것은 '성공'이라고 정의한다.

- **예제2. 초코칩 쿠키안에 든 초코의 개수**

    작은 쿠키 조각 안에는 이곳저곳에 많은 칩들이 있다. 쿠키를 조각으로 나누면 대부분의 조각에는 초코가 없겠지만, 초코렛이 있을 수 있는(Potential) 조각들은 여전히 많이 있다. 즉, 실제로는 적고 가능성은 많다는 뜻이다.

- **예제3. 특정 지역에서의 1년간 지진 발생 수**

    특정한 날 지진이 일어날 확률은 매우 낮지만, 1년은 365일이므로 1년 동안에는 지진이 몇 번 있을 수 있다.

    이것들이 **완벽하게 포아송 분포라는 것은 아니다.**  이 분포의 초기 추정으로 적절한 것이 포아송 분포라는 것이다. 실제로 포아송 분포가 쓰일 때는 뚜렷한 Upper bound가 있다. 하지만 이론에서는 무한대까지 간다. 그래서 대부분의 응용에서 이상적인 포아송 분포를 찾기 힘들지만, 대부분의 경우에는 추정하기 유용한 분포이다. 이를 **포아송 패러다임**이라고 한다. 아니면 간단하게 **포아송 근사**라고 한다.

## poisson approximation

어떤 큰 숫자 n에 대하여 $A_1, ..., A_n$ 의 여러 사건이 있다고 해보자. 그리고 각각 사건들의 확률은 $P(A_j) = p_j$ 이다. 이때, 총 사건의 개수는 많기 때문에 특정 결과가 나올 **기회**는 많다. 하지만 각 사건당 그 결과가 나올 **확률**은 매우 적다. 그리고 각 사건은 독립이거나 weakly dependent일 때, 발생하는 사건($A_j$)의 수는 $Pois(\lambda)$ 의 분포를 따른다.

(여기서 독립성에 대해서 다시 생각해보자. 만약 $A_1, A_2, A_3$ 가 일어난 걸 알았을 때, 독립성은 그 사실을 가지고 $A_4, A_5, A_6$를 유추할 수 없어야 한다. 근데 weakly dependent는 약간 영향이 있는 것이다.)

포아송 분포를 따르기 때문에 $A_j$의 실행 기대 값을 구해보면 아래와 같이 나온다.

$$λ=∑p​j​​ $$

각 사건이 의존적이어도 기대값의 선형성에 의해  $A_j$ 의 실행 기대값은 $p_j$의 합과 같다.

각 사건의 실행수는 p 확률의 이항분포임을 안다. 이제 이항분포(n,p)가 포아송 분포로 수렴하는 걸 증명할 수 있다. 여기서 이항분포는 독립적인 사건들이 같은 발생 확률($p_J$)을 가져야 하지만, 포아송분포는 달라도 되고 약간의 의존성이 허용된다.

![/assets/img/2020-10-18-statistics/Untitled%204.png](/assets/img/2020-10-18-statistics/Untitled%204.png)

- 여기서 $np = \lambda$ 는 p가 0으로 가는 속도와 $\lambda$ 가 무한으로 가는 속도가 같다는 뜻.
- n은 항상 유한하기 때문에 **포아송근사**라고 부르는 것이다.

![/assets/img/2020-10-18-statistics/Untitled%205.png](/assets/img/2020-10-18-statistics/Untitled%205.png)

- k는 상수이다. 그 이유는 n이 커지고 p가 작아질 때 특정 값에서 PMF가 어떻게 되는지 알아보려는 것이기 때문이다.

    ![/assets/img/2020-10-18-statistics/Untitled%206.png](/assets/img/2020-10-18-statistics/Untitled%206.png)

- 포아송 분포의 PMF

$$P(X=k)→ \displaystyle \frac{\lambda^k}{k!}\cdot e^{-\lambda}$$

- 증명 결과 이항분포가 포아송 분포로 수렴하는 걸 알 수 있다.

### 빗방울 예제

비가 오는 밖에 아래와 같은 종이를 놔둔다고 가정해보자. 1초에  몇 개의 빗방울이 종이에 떨어졌을까??

![/assets/img/2020-10-18-statistics/Untitled%207.png](/assets/img/2020-10-18-statistics/Untitled%207.png)

이 문제를 풀기 위해 종이를 몇 천만개의 작은 사각형으로 나눠보자. (실제로 커보이지만 아주 작다고 가정.) 그리고 각 사각형 당 특정 시간 동안 빗방울이 떨어지는 횟수를 세는 것이다.

단순히 생각해보면 천만개의 사각형 중 빗방울이 떨어진 사각형만 세면 되니까 이항분포를 쓸 수 있을 것 같다. 하지만 이항분포를 가정한다면 만족해야 될 조건이 3가지가 있다.

1. 각 사각형의 확률이 독립인가?
2. 각 사각형의 확률이 동일한가?
3. 각 사각형의 상태가 0 또는 1인가?

1번과 2번은 성립이 될 수 있지만 3번 조건은 적용되지 않는다. 왜냐하면 두 개의 빗방울이 동시에 같은 사각형에 들어 갈 수 있기 때문이다. 또한 계산적인 측면에서도 이항분포를 사용한다면 아주 큰 n과 아주 작은 p로 인해서 풀기 어려워진다.

그래서 이러한 문제에서는 포아송 분포를 사용하는 것이 간단하다.
